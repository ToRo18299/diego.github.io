---
import '../styles/global.css'
import ThemeToggle from '../components/ThemeToggle.astro'
import ThemeSelector from '../components/ThemeSelector.astro'
import ScrollNavigator from '../components/ScrollNavigator.astro'
import Navbar from '../components/Navbar.astro'
import { ClientRouter } from 'astro:transitions'
import { siteConfig } from '../config'

interface Props {
  title?: string
  description?: string
}

const {
  title = 'Bloomfolio Template',
  description = 'A modern portfolio template built with Astro and DaisyUI',
} = Astro.props

// Custom blur-fade animation configuration
const blurFadeAnimation = {
  old: {
    name: 'blurFadeOut',
    duration: '0.3s',
    easing: 'ease-in-out',
    fillMode: 'forwards',
  },
  new: {
    name: 'blurFadeIn',
    duration: '0.3s',
    easing: 'ease-in-out',
    fillMode: 'backwards',
  },
}

const pageTransition = {
  forwards: blurFadeAnimation,
  backwards: blurFadeAnimation,
}

const origin = Astro.url.origin
---

<!doctype html>
<html lang='en' transition:animate={pageTransition}>
  <head>
    <meta charset='UTF-8' />
    <meta name='viewport' content='width=device-width' />
    <meta name='description' content={description} />
    <link rel='icon' type='image/svg+xml' href='/favicon.svg' />
    <meta name='generator' content={Astro.generator} />
    <title>{title}</title>

    <!-- View Transitions -->
    <ClientRouter />

    <!-- Open Graph / Social Media -->
    <meta property='og:title' content={title} />
    <meta property='og:description' content={description} />
    <meta property='og:type' content='website' />
    <meta property='og:url' content={origin} />
    <meta property='og:image' content={`${origin}/images/og_home.png`} />

    <!-- Twitter -->
    <meta name='twitter:card' content='summary_large_image' />
    <meta name='twitter:title' content={title} />
    <meta name='twitter:description' content={description} />
    <meta name='twitter:image' content={`${origin}/images/og_home.png`} />
  </head>
  <body class='min-h-screen'>
    <!-- Theme Controls - Responsive Position -->
    <div
      class='fixed z-50 right-4 top-4 md:top-4 md:right-4 md:bottom-auto md:left-auto bottom-4 left-auto
        md:flex md:items-center'
      style='pointer-events: auto;'
    >
      <div class='block md:hidden'>
        <!-- MÃ³vil: abajo a la izquierda -->
        <div class='fixed bottom-4 left-4 z-50'>
          {siteConfig.enableThemeSelector ? <ThemeSelector /> : <ThemeToggle />}
        </div>
      </div>
      <div class='hidden md:block'>
        <!-- Desktop: abajo a la izquierda -->
        <div class='fixed bottom-4 left-4 z-50'>
          {siteConfig.enableThemeSelector ? <ThemeSelector /> : <ThemeToggle />}
        </div>
      </div>
    </div>

    <!-- Sticky Navbar with Scrollspy -->
    <Navbar />

    <slot />
    <ScrollNavigator />

    <!-- Smooth Scroll -->
    <style is:global>
      html {
        scroll-behavior: smooth;
      }

      /* Initial Page Load Blur-Fade Animation */
      @keyframes pageLoadBlurFade {
        0% {
          opacity: 0;
          filter: blur(8px);
        }
        100% {
          opacity: 1;
          filter: blur(0px);
        }
      }

      html {
        animation: pageLoadBlurFade 0.3s ease-in-out;
        animation-fill-mode: both;
      }

      /* Blur Fade View Transitions (for page-to-page navigation) */
      @keyframes blurFadeIn {
        0% {
          opacity: 0;
          filter: blur(10px);
        }
        100% {
          opacity: 1;
          filter: blur(0px);
        }
      }

      @keyframes blurFadeOut {
        0% {
          opacity: 1;
          filter: blur(0px);
        }
        100% {
          opacity: 0;
          filter: blur(10px);
        }
      }
    </style>
  </body>
</html>

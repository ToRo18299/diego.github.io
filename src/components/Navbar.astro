---
// Sticky Navbar with Scrollspy for main sections
const sections = [
  { id: 'about', label: 'About' },
  { id: 'projects', label: 'Proyectos' },
  { id: 'blog', label: 'Blog' },
  { id: 'work', label: 'Experiencia' },
  { id: 'education', label: 'Educaci√≥n' },
  { id: 'contact', label: 'Contacto' },
]
---

<nav
  class='sticky top-0 z-40 bg-base-100/80 backdrop-blur border-b border-base-200 shadow-sm'
>
  <div
    class='max-w-7xl mx-auto flex gap-2 px-4 py-2 items-center justify-between'
  >
    <!-- Logo or Brand (optional) -->
    <div class='flex-1 flex items-center'>
      <span class='font-bold text-lg md:text-xl'>Diego Ramos</span>
    </div>
    <!-- Hamburger button for mobile -->
    <button
      id='nav-toggle'
      class='md:hidden p-2 rounded focus:outline-none focus:ring-2 focus:ring-primary'
      aria-label='Open menu'
    >
      <svg
        class='w-7 h-7'
        fill='none'
        stroke='currentColor'
        stroke-width='2'
        viewBox='0 0 24 24'
      >
        <path
          stroke-linecap='round'
          stroke-linejoin='round'
          d='M4 6h16M4 12h16M4 18h16'></path>
      </svg>
    </button>
    <!-- Menu -->
    <div
      id='nav-menu'
      class='hidden md:flex flex-col md:flex-row gap-2 md:gap-6 absolute md:static top-full left-0 w-full md:w-auto bg-base-100 md:bg-transparent shadow md:shadow-none p-4 md:p-0 z-40'
    >
      <a
        href='/#about'
        class='nav-link px-3 py-1 rounded transition-colors duration-200 hover:bg-primary/10 hover:text-primary font-medium text-base-content/80'
        >About me</a
      >
      <a
        href='/#projects'
        class='nav-link px-3 py-1 rounded transition-colors duration-200 hover:bg-primary/10 hover:text-primary font-medium text-base-content/80'
        >Projects</a
      >
      <a
        href='/#blog'
        class='nav-link px-3 py-1 rounded transition-colors duration-200 hover:bg-primary/10 hover:text-primary font-medium text-base-content/80'
        >Skills & Tools</a
      >
      <a
        href='/#work'
        class='nav-link px-3 py-1 rounded transition-colors duration-200 hover:bg-primary/10 hover:text-primary font-medium text-base-content/80'
        >Experience</a
      >
      <a
        href='/#education'
        class='nav-link px-3 py-1 rounded transition-colors duration-200 hover:bg-primary/10 hover:text-primary font-medium text-base-content/80'
        >Education</a
      >
      <a
        href='/#contact'
        class='nav-link px-3 py-1 rounded transition-colors duration-200 hover:bg-primary/10 hover:text-primary font-medium text-base-content/80'
        >Contact</a
      >
    </div>
  </div>
</nav>
<style>
  .nav-link.active {
    color: var(--tw-prose-bold);
    background: var(--tw-prose-invert-bg);
    font-weight: bold;
  }
  #nav-menu {
    transition: max-height 0.3s ease;
  }
</style>
<script is:inline>
  document.addEventListener('DOMContentLoaded', function () {
    // Mobile menu toggle
    var navToggle = document.getElementById('nav-toggle')
    var navMenu = document.getElementById('nav-menu')
    if (navToggle && navMenu) {
      navToggle.addEventListener('click', function () {
        navMenu.classList.toggle('hidden')
      })
    }
    // Scrollspy logic
    var sectionIds = [
      'about',
      'projects',
      'blog',
      'work',
      'education',
      'contact',
    ]
    function updateActiveSection() {
      var found = 'about'
      for (var i = 0; i < sectionIds.length; i++) {
        var id = sectionIds[i]
        var el = document.getElementById(id)
        if (el && el.getBoundingClientRect().top <= 80) {
          found = id
        }
      }
      var links = document.querySelectorAll('.nav-link')
      for (var j = 0; j < links.length; j++) {
        var link = links[j]
        link.classList.toggle(
          'active',
          link.getAttribute('href') === '#' + found
        )
      }
    }
    window.addEventListener('scroll', updateActiveSection)
    window.addEventListener('astro:after-swap', updateActiveSection)
    updateActiveSection()
  })
</script>
